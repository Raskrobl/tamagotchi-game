< !DOCTYPE
html >
< html
lang = "ru" >
< head >
< meta
charset = "UTF-8" / >
< meta
name = "viewport"
content = "width=device-width, initial-scale=1.0" / >
< title > –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π
—Ç–∞–º–∞–≥–æ—á–∏ < / title >

< !-- Firebase
SDK -->
< script
src = "https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js" > < / script >
< script
src = "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js" > < / script >
< script
src = "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js" > < / script >

< style >
*{
    box - sizing: border - box;
margin: 0;
padding: 0;
font - family: "Segoe UI", Tahoma, Geneva, Verdana, sans - serif;
}
body
{
    background: linear - gradient(to bottom,  # 04101f, #0d2438);
color:  # f4fbff;
min - height: 100
vh;
padding: 10
px;
}
.decor - bar
{
    display: flex;
justify - content: space - between;
padding: 8
px
12
px;
font - size: 18
px;
margin - bottom: 15
px;
}
.screen
{
    max - width: 520px;
margin: 0
auto;
padding: 20
px;
background: rgba(13, 36, 56, 0.7);
border - radius: 12
px;
display: none;
}
.screen.active
{
    display: block;
}
h1
{
    font - size: 22px;
font - weight: bold;
text - align: center;
margin - bottom: 10
px;
color:  # e63946;
}    h2
{
    text - align: center;
margin: 10
px
0
16
px;
color:  # 56ccf2;
}
p
{
    text - align: center;
margin: 0
0
20
px;
color:  # a0c4e0;
}
button
{
    display: block;
width: 100 %;
padding: 10
px;
margin: 5
px
0;
background:  # 56ccf2;
color:  # 0d2438;
border: none;
border - radius: 6
px;
font - weight: bold;
font - size: 16
px;
cursor: pointer;
}
button: disabled
{
    background:  # 444;
        cursor: not -allowed;
}
button.grayed
{
    background:  # 666;
        cursor: not -allowed;
}
button.auth
{
    background:  # 4361ee;
}
button.danger
{
    background:  # ef233c;
}
button.google
{
    background:  # db4437;
}
button.loading
{
    background:  # 6c757d;
        cursor: wait;
}
input, select
{
    width: 100 %;
padding: 8
px;
margin: 6
px
0
12
px;
border - radius: 4
px;
border: 1
px
solid  # 444;      background: #0b1b2b;
color:  # f4fbff;
font - size: 16
px;
}
.stats - banner
{
    text - align: center;
font - style: italic;
color:  # a0e0ff;
margin - bottom: 8
px;
font - size: 14
px;
}
.actions
{
    display: flex;
gap: 6
px;
margin: 16
px
0;
}
.actions
button
{
    flex: 1;
font - size: 14
px;
padding: 12
px;
}
.footer
{
    text - align: center;
font - size: 13
px;
color:  # 88b0d0;
margin - top: 6
px;
}
.modal
{
    position: fixed;
top: 0;
left: 0;
width: 100 %;
height: 100 %;
background: rgba(0, 0, 0, 0.8);
display: none;
justify - content: center;
align - items: center;
}
.modal - content
{
    background:  # 0d2438;
        padding: 20
px;
border - radius: 10
px;
width: 90 %;
max - width: 400
px;
}
.checkbox - list
{
apiKey: "AIzaSyCcjVPt9obaweeOqr1NKEdcT7U7SaltFkA",
  authDomain: "tamagochi-d4cf8.firebaseapp.com",
  projectId: "tamagochi-d4cf8",
  storageBucket: "tamagochi-d4cf8.firebasestorage.app",
  messagingSenderId: "696665660103",
  appId: "1:696665660103:web:05b40d31213
}
.checkbox - list
label
{
    display: flex;
align - items: center;
margin: 8
px
0;
cursor: pointer;
}
.checkbox - list
input[type = "checkbox"] {
    width: auto;
margin: 0
10
px
0
0;
cursor: pointer;
}
.checkbox - list
input[type = "radio"] {
    width: auto;
margin: 0
10
px
0
0;
cursor: pointer;
}
.modal - content
label
{
    display: flex;
align - items: center;
margin: 8
px
0;
cursor: pointer;
}
.modal - content
input[type = "radio"] {
    width: auto;
margin: 0
10
px
0
0;
cursor: pointer;
}
.success - message
{
    background:  # 2e7d32;
        color: white;
padding: 10
px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
font - weight: bold;
}
.danger - message
{
    background:  # d32f2f;
        color: white;
padding: 15
px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
font - weight: bold;
font - size: 18
px;
}
# rage {
color:  # ff6b6b;
font - weight: bold;
}
.warning - banner
{
    background:  # ff9800;
        color:  # 000;      padding: 8px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
font - weight: bold;
}
.user - info
{
    text - align: center;
margin - bottom: 15
px;
font - size: 16
px;
color:  # 56ccf2;
}
.auth - note
{
    background:  # 1a3a52;
        padding: 12
px;
border - radius: 6
px;
margin: 10
px
0;
font - size: 13
px;
text - align: center;
}
.firebase - notice
{
    background:  # 4361ee;
        color: white;
padding: 15
px;
border - radius: 8
px;
margin: 15
px
0;
text - align: left;
font - size: 14
px;
}
.firebase - notice
strong
{
    color:  # ffcc00;
}
.email - verified
{
    background:  # 2e7d32;
        color: white;
padding: 10
px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
display: none;
}
.email -
not -verified
{
    background:  # ff9800;
        color:  # 000;
padding: 10
px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
display: none;
}.loading - spinner
{
    border: 3px solid  # 333;
    border - top: 3px solid  # 56ccf2;
    border - radius: 50 %;
width: 30
px;
height: 30
px;
animation: spin
1
s
linear
infinite;
margin: 20
px
auto;
display: none;
}

@keyframes


spin
{
    0 % {transform: rotate(0deg);}
100 % {transform: rotate(360deg);}
}
.divider
{
    text - align: center;
margin: 15
px
0;
color:  # 666;
position: relative;
}
.divider::before
{
    content: "–∏–ª–∏";
background:  # 0d2438;
padding: 0
10
px;
position: relative;
z - index: 1;
}
.divider::after
{
    content: "";
position: absolute;
top: 50 %;
left: 0;
right: 0;
border - top: 1
px
solid  # 444;
z - index: 0;
}
< / style >
< / head >
< body >

< div


class ="decor-bar" >

< span


class ="decor-left" > ‚ùÜ < / span >

< span


class ="decor-center" > –ó–∏–º–Ω—è—è —Å–∫–∞–∑–∫–∞ < / span >

< span


class ="decor-right" > ‚ùÜ < / span >

< / div >

< !-- –≠–∫—Ä–∞–Ω
–≤—Ö–æ–¥–∞ -->
< div
id = "auth-screen"


class ="screen active" >

< h1 > –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π
—Ç–∞–º–∞–≥–æ—á–∏ < / h1 >
< div


class ="firebase-notice" >

< strong >üî• Firebase
Authentication < / strong > < br > < br >
‚Ä¢ –†–µ–∞–ª—å–Ω–∞—è
–æ—Ç–ø—Ä–∞–≤–∫–∞
–ø–∏—Å–µ–º
—Å
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º ‚úÖ < br >
‚Ä¢ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ
—Ö—Ä–∞–Ω–µ–Ω–∏–µ
–ø–∞—Ä–æ–ª–µ–π(—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ) üîê < br >
‚Ä¢ –ü—Ä–æ–≥—Ä–µ—Å—Å
–∏–≥—Ä—ã
—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
–≤
–æ–±–ª–∞–∫–µ ‚òÅÔ∏è < br >
‚Ä¢ –í—Ö–æ–¥
—á–µ—Ä–µ–∑
Google
–æ–¥–Ω–∏–º
–∫–ª–∏–∫–æ–º üöÄ
< / div >

< h2 > –í—Ö–æ–¥
–≤
–∞–∫–∫–∞—É–Ω—Ç < / h2 >
< input
type = "email"
id = "login-email"
placeholder = "Email"
required / >
< input
type = "password"
id = "login-password"
placeholder = "–ü–∞—Ä–æ–ª—å"
required / >
< div


class ="loading-spinner" id="login-loading" > < / div >

< button


class ="auth" onclick="loginWithEmail()" > –í–æ–π—Ç–∏ < / button >

< div


class ="divider" > < / div >

< button


class ="google" onclick="loginWithGoogle()" >

< i


class ="fab fa-google" > < / i > –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google

< / button >

< button
onclick = "showScreen('register-screen')" > –°–æ–∑–¥–∞—Ç—å
–∞–∫–∫–∞—É–Ω—Ç < / button >
< button
onclick = "showScreen('password-reset-screen')" > –ó–∞–±—ã–ª–∏
–ø–∞—Ä–æ–ª—å? < / button >
< / div >

< !-- –≠–∫—Ä–∞–Ω
—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
< div
id = "register-screen"


class ="screen" >

< h2 > –°–æ–∑–¥–∞–Ω–∏–µ
–∞–∫–∫–∞—É–Ω—Ç–∞ < / h2 >

< input
type = "email"
id = "register-email"
placeholder = "Email"
required / >
< input
type = "password"
id = "register-password"
placeholder = "–ü–∞—Ä–æ–ª—å (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)"
required / >
< input
type = "password"
id = "register-confirm-password"
placeholder = "–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
required / >

< div


class ="loading-spinner" id="register-loading" > < / div >

< button


class ="auth" onclick="registerWithEmail()" > –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç < / button >

< button
onclick = "showScreen('auth-screen')" > –£–∂–µ
–µ—Å—Ç—å
–∞–∫–∫–∞—É–Ω—Ç? < / button >
< / div >

< !-- –≠–∫—Ä–∞–Ω
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
–ø–æ—á—Ç—ã -->
< div
id = "verify-email-screen"


class ="screen" >

< h2 >üìß –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ
–≤–∞—à—É
–ø–æ—á—Ç—É < / h2 >

< div


class ="auth-note" >


–ú—ã
–æ—Ç–ø—Ä–∞–≤–∏–ª–∏
–ø–∏—Å—å–º–æ
—Å
—Å—Å—ã–ª–∫–æ–π
–¥–ª—è
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
–Ω–∞
–≤–∞—à
–∞–¥—Ä–µ—Å. < br >
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ
–ø–æ—á—Ç—É
–∏
–Ω–∞–∂–º–∏—Ç–µ
–Ω–∞
—Å—Å—ã–ª–∫—É.
< / div >

< div


class ="email-not-verified" id="email-not-verified" >

‚ö†Ô∏è
–í–∞—à
email
–µ—â–µ
–Ω–µ
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω
< / div >
< div


class ="email-verified" id="email-verified" >

‚úÖ Email
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω! –î–æ–±—Ä–æ
–ø–æ–∂–∞–ª–æ–≤–∞—Ç—å
–≤
–∏–≥—Ä—É!
< / div >

< div


class ="loading-spinner" id="verify-loading" > < / div >

< button
onclick = "checkEmailVerification()" > –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ < / button >
< button
onclick = "sendVerificationEmail()" > –û—Ç–ø—Ä–∞–≤–∏—Ç—å
–ø–∏—Å—å–º–æ
–ø–æ–≤—Ç–æ—Ä–Ω–æ < / button >
< button


class ="danger" onclick="signOut()" > –í—ã–π—Ç–∏ < / button >

< / div >

< !-- –≠–∫—Ä–∞–Ω
—Å–±—Ä–æ—Å–∞
–ø–∞—Ä–æ–ª—è -->
< div
id = "password-reset-screen"


class ="screen" >

< h2 > –°–±—Ä–æ—Å
–ø–∞—Ä–æ–ª—è < / h2 >

< div


class ="auth-note" >


–í–≤–µ–¥–∏—Ç–µ
–≤–∞—à
email, –∏
–º—ã
–æ—Ç–ø—Ä–∞–≤–∏–º
–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
–ø–æ
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é
–ø–∞—Ä–æ–ª—è.
< / div >

< input
type = "email"
id = "reset-email"
placeholder = "–í–∞—à email"
required / >
< div


class ="loading-spinner" id="reset-loading" > < / div >

< button


class ="auth" onclick="sendPasswordReset()" > –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ < / button >

< button
onclick = "showScreen('auth-screen')" > –ù–∞–∑–∞–¥ < / button >
< / div >

< !-- –û—Å–Ω–æ–≤–Ω–æ–µ
–º–µ–Ω—é
–∏–≥—Ä—ã -->
< div
id = "main-menu"


class ="screen" >

< div


class ="user-info" id="menu-user-info" > < / div >

< h1
id = "main-title" > –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π
—Ç–∞–º–∞–≥–æ—á–∏ < / h1 >
< p
id = "main-subtitle" > –ù–∞–∂–º–∏—Ç–µ
"–ò–≥—Ä–∞—Ç—å", —á—Ç–æ–±—ã
—Å–æ–∑–¥–∞—Ç—å
—Å–≤–æ–µ–≥–æ
–ø–∏—Ç–æ–º—Ü–∞! < / p >
< button
onclick = "showCreateScreen()" > –ò–≥—Ä–∞—Ç—å < / button >
< button
onclick = "openSettings()" > –ù–∞—Å—Ç—Ä–æ–π–∫–∏ < / button >
< button
onclick = "openAddons()" > –î–æ–ø–æ–ª–Ω–µ–Ω–∏—è < / button >
< button
onclick = "showCredits()" > –°–æ–∑–¥–∞—Ç–µ–ª–∏ < / button >
< button
onclick = "openInterfaceSettings()" > –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å < / button >
< button
onclick = "openSecretMenu()" > –ü–æ–¥–∞—Ä–∫–∏ < / button >
< button


class ="danger" onclick="signOut()" > –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ < / button >

< / div >

< !-- –û—Å—Ç–∞–ª—å–Ω—ã–µ
—ç–∫—Ä–∞–Ω—ã
–∏–≥—Ä—ã -->
< div
id = "create-screen"


class ="screen" >

< div


class ="user-info" id="create-user-info" > < / div >

< h2 > –°–æ–∑–¥–∞–Ω–∏–µ
–ø–∏—Ç–æ–º—Ü–∞ < / h2 >
< label > –ò–º—è
–ø–∏—Ç–æ–º—Ü–∞: < / label >
< input
type = "text"
id = "pet-name"
maxlength = "20"
placeholder = "–ü–∏—Ç–æ–º–µ—Ü" / >
< label > –¢–∏–ø
–ø–∏—Ç–æ–º—Ü–∞: < / label >
< select
id = "pet-type" > < / select >
< button
onclick = "createPet()" > –°–æ–∑–¥–∞—Ç—å < / button >
< button
onclick = "showScreen('main-menu')" > –ù–∞–∑–∞–¥ < / button >
< / div >
< div
id = "game-screen"


class ="screen" >

< div


class ="user-info" id="game-user-info" > < / div >

< div


class ="stats-banner" > –¢—ë–ø–ª–∞—è –∑–∞–±–æ—Ç–∞ —Å–æ–≥—Ä–µ–µ—Ç –¥–∞–∂–µ –≤ —Å–∞–º—ã–π —Å–Ω–µ–∂–Ω—ã–π –¥–µ–Ω—å < / div >

< div
id = "pet-info" > –ü–∏—Ç–æ–º–µ—Ü
–µ—â—ë
–Ω–µ
—Å–æ–∑–¥–∞–Ω. < / div >
< div
id = "hunger" > –°—ã—Ç–æ—Å—Ç—å: - < / div >
< div
id = "happiness" > –°—á–∞—Å—Ç—å–µ: - < / div >
< div
id = "energy" > –≠–Ω–µ—Ä–≥–∏—è: - < / div >
< div
id = "rage"
style = "display:none;" > –Ø—Ä–æ—Å—Ç—å: - / 100 < / div >
< div
id = "warning-banner"


class ="warning-banner" style="display:none;" > < / div >

< div


class ="actions" >

< button
id = "btn-feed"
onclick = "onFeed()"
disabled > –ö–æ—Ä–º–∏—Ç—å < / button >
< button
id = "btn-play"
onclick = "onPlay()"
disabled > –ò–≥—Ä–∞—Ç—å < / button >
< button
id = "btn-sleep"
onclick = "onSleep()"
disabled > –°–ø–∞—Ç—å < / button >
< / div >
< button
onclick = "showScreen('shop-screen')" > –ú–∞–≥–∞–∑–∏–Ω < / button >
< button
onclick = "showScreen('main-menu'); clearInterval(tickInterval); clearInterval(goldInterval); clearInterval(rageTimer);" > –ù–∞–∑–∞–¥ < / button >
< div


class ="footer" > –ö–æ—Ä–º–∏—Ç–µ, –∏–≥—Ä–∞–π—Ç–µ –∏ —É–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ —Å–ø–∞—Ç—å ‚Äì –∏ –ø–∏—Ç–æ–º–µ—Ü –±—É–¥–µ—Ç —Å—á–∞—Å—Ç–ª–∏–≤ < / div >

< / div >

< div
id = "shop-screen"


class ="screen" >

< div


class ="user-info" id="shop-user-info" > < / div >

< h2 > –ú–∞–≥–∞–∑–∏–Ω
—á—É–¥–µ—Å < / h2 >
< p > –í–∞—à–∏
–º–æ–Ω–µ—Ç—ã: < span
id = "gold" > 0 < / span > ü™ô < / p >
< button
onclick = "buyPotion('revive')" > –ó–µ–ª—å–µ
–∑–¥–æ—Ä–æ–≤—å—è ‚Äî 50 ü™ô < br > < small > –û–∂–∏–≤–ª—è–µ—Ç
–º—ë—Ä—Ç–≤–æ–≥–æ
–ø–∏—Ç–æ–º—Ü–∞ < / small > < / button >
< button
onclick = "buyPotion('satiety')" > –ó–µ–ª—å–µ
—Å—ã—Ç–æ—Å—Ç–∏ ‚Äî 30 ü™ô < br > < small > –ü–∏—Ç–æ–º–µ—Ü
—Å—ã—Ç
5
–º–∏–Ω—É—Ç < / small > < / button >
< button
onclick = "buyPotion('strength')" > –ó–µ–ª—å–µ
—Å–∏–ª—ã ‚Äî 40 ü™ô < br > < small > +50
–∫–æ
–≤—Å–µ–º
—Å—Ç–∞—Ç–∞–º < / small > < / button >
< button
id = "btn-calm"
onclick = "buyPotion('calm')" > –ó–µ–ª—å–µ
—Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è ‚Äî 20 ü™ô < br > < small > –°–Ω–∏–∂–∞–µ—Ç
—è—Ä–æ—Å—Ç—å
–Ω–∞
50(—Ç–æ–ª—å–∫–æ
–¥–ª—è
–î–∏–∫–∏—Ö
–ó–≤–µ—Ä–µ–π) < / small > < / button >
< button
onclick = "showScreen('game-screen')" > –ù–∞–∑–∞–¥
–≤
–∏–≥—Ä—É < / button >
< / div >

< div
id = "modal"


class ="modal" >

< div


class ="modal-content" id="modal-content" > < / div >

< / div >

< script >
// == == == == == == == == == == == == == == == == == == == ==
// ‚öôÔ∏è
–ù–ê–°–¢–†–û–ô–ö–ò
FIREBASE(–ó–ê–ú–ï–ù–ò–¢–ï
–ù–ê
–°–í–û–ò!)
// == == == == == == == == == == == == == == == == == == == ==
const
firebaseConfig = {
    apiKey: "AIzaSyCvBZ9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9",
    authDomain: "your-project.firebaseapp.com",
    projectId: "your-project",
    storageBucket: "your-project.appspot.com",
    messagingSenderId: "123456789012",
    appId: "1:123456789012:web:abcdef1234567890abcdef12"
};

// == == == == == == == == == == == == == == == == == == == ==
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
FIREBASE // == == == == == == == == == == == == == == == == == == == ==
let
appInitialized = false;
let
currentUser = null;
let
db = null;
let
auth = null;

function
initializeFirebase()
{
if (appInitialized)
return;

try {
// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–≤–µ–¥–µ–Ω—ã –ª–∏ –Ω–∞—Å—Ç–æ—è—â–∏–µ –∫–ª—é—á–∏
if (firebaseConfig.apiKey == = "AIzaSyCvBZ9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9") {
alert("‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï!\n\n–í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –¥–µ–º–æ-–∫–ª—é—á–∏ Firebase. –î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:\n\n1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://console.firebase.google.com\n2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç\n3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ \"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞\" ‚Üí \"–í–∞—à–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è\"\n4. –î–æ–±–∞–≤—å—Ç–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥\n5. –í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥ –≤ —Å—Ç—Ä–æ–∫–∏ 220-227 —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞");
showFirebaseInstructions();
return;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
Firebase
firebase.initializeApp(firebaseConfig);
auth = firebase.auth();
db = firebase.firestore();

appInitialized = true;
console.log("‚úÖ Firebase —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");

// –°–ª—É—à–∞—Ç–µ–ª—å
—Å–æ—Å—Ç–æ—è–Ω–∏—è
–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
auth.onAuthStateChanged(user= > {
if (user)
{
    currentUser = user;
console.log("‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª:", user.email);

// –ü—Ä–æ–≤–µ—Ä—è–µ–º
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
–ø–æ—á—Ç—ã
if (!user.emailVerified)
{
    showScreen('verify-email-screen');
document.getElementById('email-not-verified').style.display = 'block';
document.getElementById('email-verified').style.display = 'none';
} else {
       // –ó–∞–≥—Ä—É–∂–∞–µ–º
–ø—Ä–æ–≥—Ä–µ—Å—Å
–∏–≥—Ä—ã
loadGameProgress();
updateUserDisplays();
showScreen('main-menu');
}
} else {
    currentUser = null;
showScreen('auth-screen');
}
});

} catch(error)
{
    console.error("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:", error);
alert(`–û—à–∏–±–∫–∞
–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
Firebase:\n${error.message}\n\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ
–∫–æ–Ω—Å–æ–ª—å
–±—Ä–∞—É–∑–µ—Ä–∞(F12)
–¥–ª—è
–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.
`);
}
}

// == == == == == == == == == == == == == == == == == == == ==
// –§–£–ù–ö–¶–ò–ò
–ê–í–¢–û–†–ò–ó–ê–¶–ò–ò
// == == == == == == == == == == == == == == == == == == == ==
function
showScreen(id)
{
    document.querySelectorAll('.screen').forEach(el= > el.classList.remove('active'));
document.getElementById(id).classList.add('active');

// –û—á–∏—Å—Ç–∫–∞
–ø–æ–ª–µ–π
–ø—Ä–∏
–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
if (id === 'register-screen')
{
    document.getElementById('register-email').value = '';
document.getElementById('register-password').value = '';
document.getElementById('register-confirm-password').value = '';
document.getElementById('register-loading').style.display = 'none';
} else if (id === 'auth-screen') {
document.getElementById('login-email').value = '';
document.getElementById('login-password').value = '';
document.getElementById('login-loading').style.display = 'none';
} else if (id == = 'password-reset-screen') {
document.getElementById('reset-email').value = '';
document.getElementById('reset-loading').style.display = 'none';
}
}

function updateUserDisplays() {
if (!currentUser)
return;

const
displayName = currentUser.displayName | | currentUser.email.split('@')[0];
const
emailVerified = currentUser.emailVerified ? ' ‚úÖ': ' ‚ö†Ô∏è';

document.querySelectorAll('.user-info').forEach(el= > {
    el.textContent = `üë§ ${displayName}${emailVerified}
`;
});
}

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
–ø–æ
–ø–æ—á—Ç–µ
async function
registerWithEmail()
{
const
email = document.getElementById('register-email').value.trim();
const
password = document.getElementById('register-password').value;
const
confirmPassword = document.getElementById('register-confirm-password').value;

// –í–∞–ª–∏–¥–∞—Ü–∏—è
if (!email | | !email.includes('@')) {
alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email!');
return;
}
if (password.length < 6) {
alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤!');
return;
}

if (password !== confirmPassword) {
alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!');
return;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º
Firebase
initializeFirebase();
if (!appInitialized)
return;

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º
—Å–ø–∏–Ω–Ω–µ—Ä
const
loadingSpinner = document.getElementById('register-loading');
loadingSpinner.style.display = 'block';
const
registerBtn = event.target;
registerBtn.disabled = true;

try {
// –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const userCredential = await auth.createUserWithEmailAndPassword(email, password);
const user = userCredential.user;

// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–∏—Å—å–º–æ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
await user.sendEmailVerification();

loadingSpinner.style.display = 'none';
registerBtn.disabled = false;

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
showScreen('verify-email-screen');
document.getElementById('email-not-verified').style.display = 'block';

alert(`‚úÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω!\n–ú—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –ø–∏—Å—å–º–æ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –Ω–∞ ${email}.\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Å—ã–ª–∫—É.`);

} catch (error) {
loadingSpinner.style.display = 'none';
registerBtn.disabled = false;

let errorMessage = '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ';
switch (error.code) {
case 'auth/email-already-in-use':
    errorMessage = '–≠—Ç–æ—Ç email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!';
break;
case
'auth/invalid-email':
errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email!';
break;
case
'auth/weak-password': errorMessage = '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–π (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)!';
break;
default:
errorMessage = error.message;
}

alert(errorMessage);
console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
}
}

// –í—Ö–æ–¥
–ø–æ
–ø–æ—á—Ç–µ
async function
loginWithEmail()
{
    const
email = document.getElementById('login-email').value.trim();
const
password = document.getElementById('login-password').value;

if (!email | | !password)
{
    alert('–í–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å!');
return;
}

initializeFirebase();
if (!appInitialized)
return;

const
loadingSpinner = document.getElementById('login-loading');
loadingSpinner.style.display = 'block';
const
loginBtn = event.target;
loginBtn.disabled = true;

try {
await auth.signInWithEmailAndPassword(email, password);

loadingSpinner.style.display = 'none';
loginBtn.disabled = false;

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–π–¥–µ—Ç –Ω–∞ –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω —á–µ—Ä–µ–∑ onAuthStateChanged

} catch (error) {
loadingSpinner.style.display = 'none';
loginBtn.disabled = false;

let errorMessage = '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ';
switch (error.code) {
case 'auth/user-not-found':
    errorMessage = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω!';
break;
case
'auth/wrong-password':
errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!';
break;
case
'auth/invalid-email': errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email!';
break;
case
'auth/user-disabled':
errorMessage = '–ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!';
break;
default:
errorMessage = error.message;
}

alert(errorMessage);
console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
}
}

// –í—Ö–æ–¥
—á–µ—Ä–µ–∑
Google
async function
loginWithGoogle()
{
    initializeFirebase();
if (!appInitialized)
return;

const
provider = new
firebase.auth.GoogleAuthProvider();

try {
await auth.signInWithPopup(provider);
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–π–¥–µ—Ç –Ω–∞ –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω

} catch (error) {
if (error.code != = 'auth/popup-closed-by-user') {
alert(`–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google: $
    {error.message}
`);
console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google:', error);
}
}
}

// –û—Ç–ø—Ä–∞–≤–∫–∞
–ø–∏—Å—å–º–∞
—Å
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
async function
sendVerificationEmail()
{
if (!currentUser) {
alert('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã!');
return;
}

const
loadingSpinner = document.getElementById('verify-loading');
loadingSpinner.style.display = 'block';

try {
await currentUser.sendEmailVerification();

loadingSpinner.style.display = 'none';
alert(`‚úÖ –ü–∏—Å—å–º–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ ${currentUser.email}!\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É.`);

} catch (error) {loadingSpinner.style.display = 'none';
alert(`–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: $
    {error.message}
`);
console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞:', error);
}
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
–ø–æ—á—Ç—ã
async function
checkEmailVerification()
{
if (!currentUser) return;

const
loadingSpinner = document.getElementById('verify-loading');
loadingSpinner.style.display = 'block';

try {
await currentUser.reload();

loadingSpinner.style.display = 'none';

if (currentUser.emailVerified) {
document.getElementById('email-not-verified').style.display = 'none';
document.getElementById('email-verified').style.display = 'block';

// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä—ã
await loadGameProgress();
updateUserDisplays();
showScreen('main-menu');

showSuccessModal('üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É!');
} else {
alert('Email –µ—â–µ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Å—ã–ª–∫—É.');
}

} catch (error) {
loadingSpinner.style.display = 'none';
alert(`–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: $
    {error.message}
`);
console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—á—Ç—ã:', error);
}
}

// –°–±—Ä–æ—Å
–ø–∞—Ä–æ–ª—è
async function
sendPasswordReset()
{
const
email = document.getElementById('reset-email').value.trim();

if (!email | | !email.includes('@')) {
alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email!');
return;
}

initializeFirebase();
if (!appInitialized)
return;
const
loadingSpinner = document.getElementById('reset-loading');
loadingSpinner.style.display = 'block';

try {
await auth.sendPasswordResetEmail(email);

loadingSpinner.style.display = 'none';
alert(`‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –ø–∞—Ä–æ–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ ${email}!\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É.`);
showScreen('auth-screen');

} catch (error) {
loadingSpinner.style.display = 'none';

let errorMessage = '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ';
switch (error.code) {
case 'auth/user-not-found':
    errorMessage = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω!';
break;
case
'auth/invalid-email':
errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email!';
break;
default:
errorMessage = error.message;
}

alert(errorMessage);
console.error('–û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è:', error);
}
}

// –í—ã—Ö–æ–¥
–∏–∑
–∞–∫–∫–∞—É–Ω—Ç–∞
async function
signOut()
{
if (!auth)
{
    showScreen('auth-screen');
return;
}

try {
// –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º
await saveGameProgress();

await auth.signOut();
currentUser = null;
gold = 0;
pet = null;
clearInterval(tickInterval);
clearInterval(goldInterval);
clearInterval(rageTimer);
showScreen('auth-screen');

} catch (error) {
alert(`–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞: $
    {error.message}
`);
console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
}
}

// == == == == == == == == == == == == == == == == == == == ==
// –°–û–•–†–ê–ù–ï–ù–ò–ï
–ò
–ó–ê–ì–†–£–ó–ö–ê
–ü–†–û–ì–†–ï–°–°–ê
–ò–ì–†–´
// == == == == == == == == == == == == == == == == == == == ==
async function
saveGameProgress()
{
if (!currentUser | | !db) return;

try {
const userDoc = db.collection('users').doc(currentUser.uid);

const data = {
gold: gold,
lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
};

if (pet) {
data.pet = {
name: pet.name,
petType: pet.petType,
hunger: pet.hunger,
happiness: pet.happiness,
energy: pet.energy,
rage: pet.rage,
alive: pet.alive,
isWildBeast: pet.isWildBeast,
maxStat: pet.maxStat,
rageCountdownActive: pet.rageCountdownActive,
rageCountdownTime: pet.rageCountdownTime
};
} else {
    data.pet = null;
}

await userDoc.set(data, {merge: true});
console.log('‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω');

} catch(error)
{
    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:', error);
}
}

async function
loadGameProgress()
{
if (!currentUser | | !db) return;
try {
const userDoc = await db.collection('users').doc(currentUser.uid).get();

if (userDoc.exists) {
const data = userDoc.data();

gold = data.gold | | 0;

if (data.pet) {
const savedPet = data.pet;
pet = new Pet(savedPet.name, savedPet.petType);
pet.hunger = savedPet.hunger;
pet.happiness = savedPet.happiness;
pet.energy = savedPet.energy;
pet.alive = savedPet.alive;

if (savedPet.isWildBeast) {
pet.rage = savedPet.rage | | 0;
pet.rageCountdownActive = savedPet.rageCountdownActive | | false;
pet.rageCountdownTime = savedPet.rageCountdownTime | | 0;

if (pet.rageCountdownActive) {
startRageCountdown();
}
}

// –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä—ã –∏–≥—Ä—ã
clearInterval(tickInterval);
tickInterval = setInterval(() = > {
if (pet) {pet.tick(); updateUI();}
}, 3000);

clearInterval(goldInterval);
goldInterval = setInterval(() = > {
gold += 1;
updateUI();
}, 5000);
}

updateUI();
console.log('‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∂–µ–Ω');
}

} catch (error) {
console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:', error);
}
}

function
showSuccessModal(message)
{const
content = `
< div


class ="success-message" > ${message} < / div >

< br >
< button
onclick = "closeModal()" > OK < / button >
–û—Ç–ª–∏—á–Ω–æ! –í–æ—Ç
–ø–æ–ª–Ω–∞—è
–≤–µ—Ä—Å–∏—è
–∏–≥—Ä—ã
—Å
–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π ** Firebase
Authentication ** ‚Äî —ç—Ç–æ
–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ, –Ω–∞–¥–µ–∂–Ω–æ–µ
—Ä–µ—à–µ–Ω–∏–µ
—Å
—Ä–µ–∞–ª—å–Ω–æ–π
–æ—Ç–ø—Ä–∞–≤–∫–æ–π
–ø–∏—Å–µ–º
–∏
—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
–¥–∞–Ω–Ω—ã—Ö
–≤
–æ–±–ª–∞–∫–µ!

---

## üéÆ –ü–û–õ–ù–´–ô –ö–û–î –ò–ì–†–´ –°–û –í–°–¢–†–û–ï–ù–ù–û–ô –ê–í–¢–û–†–ò–ó–ê–¶–ò–ï–ô

```html
< !DOCTYPE
html >
< html
lang = "ru" >
< head >
< meta
charset = "UTF-8" / >
< meta
name = "viewport"
content = "width=device-width, initial-scale=1.0" / >
< title > –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π
—Ç–∞–º–∞–≥–æ—á–∏ < / title >

< !-- Firebase
SDK -->
< script
src = "https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js" > < / script >
< script
src = "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js" > < / script >
< script
src = "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js" > < / script >

< style >
*{
    box - sizing: border - box;
margin: 0;
padding: 0;
font - family: "Segoe UI", Tahoma, Geneva, Verdana, sans - serif;
}
body
{
    background: linear - gradient(to bottom,  # 04101f, #0d2438);
color:  # f4fbff;
min - height: 100
vh;
padding: 10
px;
}
.decor - bar
{
    display: flex;
justify - content: space - between;
padding: 8
px
12
px;
font - size: 18
px;
margin - bottom: 15
px;
}
.screen
{
    max - width: 520px;
margin: 0
auto;
padding: 20
px;
background: rgba(13, 36, 56, 0.7);
border - radius: 12
px;
display: none;}
.screen.active
{
    display: block;
}
h1
{
    font - size: 22px;
font - weight: bold;
text - align: center;
margin - bottom: 10
px;
color:  # e63946;
}
h2
{
    text - align: center;
margin: 10
px
0
16
px;
color:  # 56ccf2;
}
p
{
    text - align: center;
margin: 0
0
20
px;
color:  # a0c4e0;
}
button
{
    display: block;
width: 100 %;
padding: 10
px;
margin: 5
px
0;
background:  # 56ccf2;
color:  # 0d2438;
border: none;
border - radius: 6
px;
font - weight: bold;
font - size: 16
px;
cursor: pointer;
}
button: disabled
{
    background:  # 444;
        cursor: not -allowed;
}
button.grayed
{
    background:  # 666;
        cursor: not -allowed;
}
button.auth
{
    background:  # 4361ee;
}
button.danger
{
    background:  # ef233c;
}
button.google
{
    background:  # db4437;    }
        button.loading {
    background:  # 6c757d;
        cursor: wait;
}
input, select
{
    width: 100 %;
padding: 8
px;
margin: 6
px
0
12
px;
border - radius: 4
px;
border: 1
px
solid  # 444;
background:  # 0b1b2b;
color:  # f4fbff;
font - size: 16
px;
}
.stats - banner
{
    text - align: center;
font - style: italic;
color:  # a0e0ff;
margin - bottom: 8
px;
font - size: 14
px;
}
.actions
{
    display: flex;
gap: 6
px;
margin: 16
px
0;
}
.actions
button
{
    flex: 1;
font - size: 14
px;
padding: 12
px;
}
.footer
{
    text - align: center;
font - size: 13
px;
color:  # 88b0d0;
margin - top: 6
px;
}
.modal
{
    position: fixed;
top: 0;
left: 0;
width: 100 %;
height: 100 %;
background: rgba(0, 0, 0, 0.8);
display: none;
justify - content: center;
align - items: center;
}
.modal - content
{
    background:  # 0d2438;
        padding: 20
px;
border - radius: 10
px;
width: 90 %;
max - width: 400
px;
}
.checkbox - list
{
    text - align: left;
margin: 10
px
0;
}
.checkbox - list
label
{
    display: flex;
align - items: center;
margin: 8
px
0;
cursor: pointer;
}
.checkbox - list
input[type = "checkbox"] {
    width: auto;
margin: 0
10
px
0
0;
cursor: pointer;
}
.checkbox - list
input[type = "radio"] {
    width: auto;
margin: 0
10
px
0
0;
cursor: pointer;
}
.modal - content
label
{
    display: flex;
align - items: center;
margin: 8
px
0;
cursor: pointer;
}
.modal - content
input[type = "radio"] {
    width: auto;
margin: 0
10
px
0
0;
cursor: pointer;
}
.success - message
{
    background:  # 2e7d32;
        color: white;
padding: 10
px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
font - weight: bold;
}
.danger - message
{
    background:  # d32f2f;
        color: white;
padding: 15
px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
font - weight: bold;
font - size: 18
px;
}
# rage {
color:  # ff6b6b;
font - weight: bold;
}
.warning - banner
{
    background:  # ff9800;
        color:  # 000;
padding: 8
px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
font - weight: bold;
}
.user - info
{
    text - align: center;
margin - bottom: 15
px;
font - size: 16
px;
color:  # 56ccf2;
}
.auth - note
{
    background:  # 1a3a52;
        padding: 12
px;
border - radius: 6
px;
margin: 10
px
0;
font - size: 13
px;
text - align: center;
}
.firebase - notice
{
    background:  # 4361ee;
        color: white;
padding: 15
px;
border - radius: 8
px;
margin: 15
px
0;
text - align: left;
font - size: 14
px;
}
.firebase - notice
strong
{
    color:  # ffcc00;
}
.email - verified
{
    background:  # 2e7d32;
        color: white;
padding: 10
px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
display: none;
}
.email -
not -verified
{
    background:  # ff9800;
        color:  # 000;
padding: 10
px;
border - radius: 6
px;
text - align: center;
margin: 10
px
0;
display: none;
}
.loading - spinner
{
    border: 3px solid  # 333;
    border - top: 3px solid  # 56ccf2;
    border - radius: 50 %;
width: 30
px;
height: 30
px;
animation: spin
1
s
linear
infinite;
margin: 20
px
auto;
display: none;
}

@keyframes


spin
{
    0 % {transform: rotate(0deg);}
100 % {transform: rotate(360deg);}
}
.divider
{
    text - align: center;
margin: 15
px
0;
color:  # 666;
position: relative;
}
.divider::before
{
    content: "–∏–ª–∏";
background:  # 0d2438;
padding: 0
10
px;
position: relative;
z - index: 1;
}
.divider::after
{
    content: "";
position: absolute;
top: 50 %;
left: 0;
right: 0;
border - top: 1
px
solid  # 444;
z - index: 0;
}
< / style >
    < / head >
        < body >
        < div


class ="decor-bar" >

< span


class ="decor-left" > ‚ùÜ < / span >

< span


class ="decor-center" > –ó–∏–º–Ω—è—è —Å–∫–∞–∑–∫–∞ < / span >

< span


class ="decor-right" > ‚ùÜ < / span >

< / div >

< !-- –≠–∫—Ä–∞–Ω
–≤—Ö–æ–¥–∞ -->
< div
id = "auth-screen"


class ="screen active" >

< h1 > –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π
—Ç–∞–º–∞–≥–æ—á–∏ < / h1 >

< div


class ="firebase-notice" >

< strong >üî• Firebase
Authentication < / strong > < br > < br >
‚Ä¢ –†–µ–∞–ª—å–Ω–∞—è
–æ—Ç–ø—Ä–∞–≤–∫–∞
–ø–∏—Å–µ–º
—Å
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º ‚úÖ < br >
‚Ä¢ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ
—Ö—Ä–∞–Ω–µ–Ω–∏–µ
–ø–∞—Ä–æ–ª–µ–π(—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ) üîê < br >
‚Ä¢ –ü—Ä–æ–≥—Ä–µ—Å—Å
–∏–≥—Ä—ã
—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
–≤
–æ–±–ª–∞–∫–µ ‚òÅÔ∏è < br >
‚Ä¢ –í—Ö–æ–¥
—á–µ—Ä–µ–∑
Google
–æ–¥–Ω–∏–º
–∫–ª–∏–∫–æ–º üöÄ
< / div >

< h2 > –í—Ö–æ–¥
–≤
–∞–∫–∫–∞—É–Ω—Ç < / h2 >
< input
type = "email"
id = "login-email"
placeholder = "Email"
required / >
< input
type = "password"
id = "login-password"
placeholder = "–ü–∞—Ä–æ–ª—å"
required / >
< div


class ="loading-spinner" id="login-loading" > < / div >

< button


class ="auth" onclick="loginWithEmail()" > –í–æ–π—Ç–∏ < / button >

< div


class ="divider" > < / div >

< button


class ="google" onclick="loginWithGoogle()" >

< i


class ="fab fa-google" > < / i > –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google

< / button >

< button
onclick = "showScreen('register-screen')" > –°–æ–∑–¥–∞—Ç—å
–∞–∫–∫–∞—É–Ω—Ç < / button >
< button
onclick = "showScreen('password-reset-screen')" > –ó–∞–±—ã–ª–∏
–ø–∞—Ä–æ–ª—å? < / button >
< / div >

< !-- –≠–∫—Ä–∞–Ω
—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
< div
id = "register-screen"


class ="screen" >

< h2 > –°–æ–∑–¥–∞–Ω–∏–µ
–∞–∫–∫–∞—É–Ω—Ç–∞ < / h2 >

< input
type = "email"
id = "register-email"
placeholder = "Email"
required / >
< input
type = "password"
id = "register-password"
placeholder = "–ü–∞—Ä–æ–ª—å (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)"
required / >
< input
type = "password"
id = "register-confirm-password"
placeholder = "–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
required / >

< div


class ="loading-spinner" id="register-loading" > < / div >

< button


class ="auth" onclick="registerWithEmail()" > –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç < / button >

< button
onclick = "showScreen('auth-screen')" > –£–∂–µ
–µ—Å—Ç—å
–∞–∫–∫–∞—É–Ω—Ç? < / button >
< / div >

< !-- –≠–∫—Ä–∞–Ω
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
–ø–æ—á—Ç—ã -->
< div
id = "verify-email-screen"


class ="screen" > < h2 > üìß –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤–∞—à—É –ø–æ—á—Ç—É < / h2 >

< div


class ="auth-note" >


–ú—ã
–æ—Ç–ø—Ä–∞–≤–∏–ª–∏
–ø–∏—Å—å–º–æ
—Å
—Å—Å—ã–ª–∫–æ–π
–¥–ª—è
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
–Ω–∞
–≤–∞—à
–∞–¥—Ä–µ—Å. < br >
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ
–ø–æ—á—Ç—É
–∏
–Ω–∞–∂–º–∏—Ç–µ
–Ω–∞
—Å—Å—ã–ª–∫—É.
< / div >

< div


class ="email-not-verified" id="email-not-verified" >

‚ö†Ô∏è
–í–∞—à
email
–µ—â–µ
–Ω–µ
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω
< / div >

< div


class ="email-verified" id="email-verified" >

‚úÖ Email
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω! –î–æ–±—Ä–æ
–ø–æ–∂–∞–ª–æ–≤–∞—Ç—å
–≤
–∏–≥—Ä—É!
< / div >

< div


class ="loading-spinner" id="verify-loading" > < / div >

< button
onclick = "checkEmailVerification()" > –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ < / button >
< button
onclick = "sendVerificationEmail()" > –û—Ç–ø—Ä–∞–≤–∏—Ç—å
–ø–∏—Å—å–º–æ
–ø–æ–≤—Ç–æ—Ä–Ω–æ < / button >
< button


class ="danger" onclick="signOut()" > –í—ã–π—Ç–∏ < / button >

< / div >

< !-- –≠–∫—Ä–∞–Ω
—Å–±—Ä–æ—Å–∞
–ø–∞—Ä–æ–ª—è -->
< div
id = "password-reset-screen"


class ="screen" >

< h2 > –°–±—Ä–æ—Å
–ø–∞—Ä–æ–ª—è < / h2 >

< div


class ="auth-note" >


–í–≤–µ–¥–∏—Ç–µ
–≤–∞—à
email, –∏
–º—ã
–æ—Ç–ø—Ä–∞–≤–∏–º
–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
–ø–æ
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é
–ø–∞—Ä–æ–ª—è.
< / div >

< input
type = "email"
id = "reset-email"
placeholder = "–í–∞—à email"
required / >
< div


class ="loading-spinner" id="reset-loading" > < / div >

< button


class ="auth" onclick="sendPasswordReset()" > –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ < / button >

< button
onclick = "showScreen('auth-screen')" > –ù–∞–∑–∞–¥ < / button >
< / div >

< !-- –û—Å–Ω–æ–≤–Ω–æ–µ
–º–µ–Ω—é
–∏–≥—Ä—ã -->
< div
id = "main-menu"


class ="screen" >

< div


class ="user-info" id="menu-user-info" > < / div >

< h1
id = "main-title" > –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π
—Ç–∞–º–∞–≥–æ—á–∏ < / h1 >
< p
id = "main-subtitle" > –ù–∞–∂–º–∏—Ç–µ
"–ò–≥—Ä–∞—Ç—å", —á—Ç–æ–±—ã
—Å–æ–∑–¥–∞—Ç—å
—Å–≤–æ–µ–≥–æ
–ø–∏—Ç–æ–º—Ü–∞! < / p >
< button
onclick = "showCreateScreen()" > –ò–≥—Ä–∞—Ç—å < / button >
< button
onclick = "openSettings()" > –ù–∞—Å—Ç—Ä–æ–π–∫–∏ < / button >
< button
onclick = "openAddons()" > –î–æ–ø–æ–ª–Ω–µ–Ω–∏—è < / button >
< button
onclick = "showCredits()" > –°–æ–∑–¥–∞—Ç–µ–ª–∏ < / button >
< button
onclick = "openInterfaceSettings()" > –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å < / button >
< button
onclick = "openSecretMenu()" > –ü–æ–¥–∞—Ä–∫–∏ < / button >
< button


class ="danger" onclick="signOut()" > –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ < / button >

< / div >
< !-- –û—Å—Ç–∞–ª—å–Ω—ã–µ
—ç–∫—Ä–∞–Ω—ã
–∏–≥—Ä—ã -->
< div
id = "create-screen"


class ="screen" >

< div


class ="user-info" id="create-user-info" > < / div >

< h2 > –°–æ–∑–¥–∞–Ω–∏–µ
–ø–∏—Ç–æ–º—Ü–∞ < / h2 >
< label > –ò–º—è
–ø–∏—Ç–æ–º—Ü–∞: < / label >
< input
type = "text"
id = "pet-name"
maxlength = "20"
placeholder = "–ü–∏—Ç–æ–º–µ—Ü" / >
< label > –¢–∏–ø
–ø–∏—Ç–æ–º—Ü–∞: < / label >
< select
id = "pet-type" > < / select >
< button
onclick = "createPet()" > –°–æ–∑–¥–∞—Ç—å < / button >
< button
onclick = "showScreen('main-menu')" > –ù–∞–∑–∞–¥ < / button >
< / div >

< div
id = "game-screen"


class ="screen" >

< div


class ="user-info" id="game-user-info" > < / div >

< div


class ="stats-banner" > –¢—ë–ø–ª–∞—è –∑–∞–±–æ—Ç–∞ —Å–æ–≥—Ä–µ–µ—Ç –¥–∞–∂–µ –≤ —Å–∞–º—ã–π —Å–Ω–µ–∂–Ω—ã–π –¥–µ–Ω—å < / div >

< div
id = "pet-info" > –ü–∏—Ç–æ–º–µ—Ü
–µ—â—ë
–Ω–µ
—Å–æ–∑–¥–∞–Ω. < / div >
< div
id = "hunger" > –°—ã—Ç–æ—Å—Ç—å: - < / div >
< div
id = "happiness" > –°—á–∞—Å—Ç—å–µ: - < / div >
< div
id = "energy" > –≠–Ω–µ—Ä–≥–∏—è: - < / div >
< div
id = "rage"
style = "display:none;" > –Ø—Ä–æ—Å—Ç—å: - / 100 < / div >
< div
id = "warning-banner"


class ="warning-banner" style="display:none;" > < / div >

< div


class ="actions" >

< button
id = "btn-feed"
onclick = "onFeed()"
disabled > –ö–æ—Ä–º–∏—Ç—å < / button >
< button
id = "btn-play"
onclick = "onPlay()"
disabled > –ò–≥—Ä–∞—Ç—å < / button >
< button
id = "btn-sleep"
onclick = "onSleep()"
disabled > –°–ø–∞—Ç—å < / button >
< / div >
< button
onclick = "showScreen('shop-screen')" > –ú–∞–≥–∞–∑–∏–Ω < / button >
< button
onclick = "showScreen('main-menu'); clearInterval(tickInterval); clearInterval(goldInterval); clearInterval(rageTimer);" > –ù–∞–∑–∞–¥ < / button >
< div


class ="footer" > –ö–æ—Ä–º–∏—Ç–µ, –∏–≥—Ä–∞–π—Ç–µ –∏ —É–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ —Å–ø–∞—Ç—å ‚Äì –∏ –ø–∏—Ç–æ–º–µ—Ü –±—É–¥–µ—Ç —Å—á–∞—Å—Ç–ª–∏–≤ < / div >

< / div >

< div
id = "shop-screen"


class ="screen" >

< div


class ="user-info" id="shop-user-info" > < / div >

< h2 > –ú–∞–≥–∞–∑–∏–Ω
—á—É–¥–µ—Å < / h2 >
< p > –í–∞—à–∏
–º–æ–Ω–µ—Ç—ã: < span
id = "gold" > 0 < / span > ü™ô < / p >
< button
onclick = "buyPotion('revive')" > –ó–µ–ª—å–µ
–∑–¥–æ—Ä–æ–≤—å—è ‚Äî 50 ü™ô < br > < small > –û–∂–∏–≤–ª—è–µ—Ç
–º—ë—Ä—Ç–≤–æ–≥–æ
–ø–∏—Ç–æ–º—Ü–∞ < / small > < / button >
< button
onclick = "buyPotion('satiety')" > –ó–µ–ª—å–µ
—Å—ã—Ç–æ—Å—Ç–∏ ‚Äî 30 ü™ô < br > < small > –ü–∏—Ç–æ–º–µ—Ü
—Å—ã—Ç
5
–º–∏–Ω—É—Ç < / small > < / button >
< button
onclick = "buyPotion('strength')" > –ó–µ–ª—å–µ
—Å–∏–ª—ã ‚Äî 40 ü™ô < br > < small > +50
–∫–æ
–≤—Å–µ–º
—Å—Ç–∞—Ç–∞–º < / small > < / button >
< button
id = "btn-calm"
onclick = "buyPotion('calm')" > –ó–µ–ª—å–µ
—Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è ‚Äî 20 ü™ô < br > < small > –°–Ω–∏–∂–∞–µ—Ç
—è—Ä–æ—Å—Ç—å
–Ω–∞
50(—Ç–æ–ª—å–∫–æ
–¥–ª—è
–î–∏–∫–∏—Ö
–ó–≤–µ—Ä–µ–π) < / small > < / button >
< button
onclick = "showScreen('game-screen')" > –ù–∞–∑–∞–¥
–≤
–∏–≥—Ä—É < / button >
< / div >

< div
id = "modal"


class ="modal" >

< div


class ="modal-content" id="modal-content" > < / div >

< / div >

< script >
// == == == == == == == == == == == == == == == == == == == ==
// ‚öôÔ∏è
–ù–ê–°–¢–†–û–ô–ö–ò
FIREBASE(–ó–ê–ú–ï–ù–ò–¢–ï
–ù–ê
–°–í–û–ò!)
// == == == == == == == == == == == == == == == == == == == == const
firebaseConfig = {
    apiKey: "AIzaSyCvBZ9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9",
    authDomain: "your-project.firebaseapp.com",
    projectId: "your-project",
    storageBucket: "your-project.appspot.com",
    messagingSenderId: "123456789012",
    appId: "1:123456789012:web:abcdef1234567890abcdef12"
};

// == == == == == == == == == == == == == == == == == == == ==
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
FIREBASE
// == == == == == == == == == == == == == == == == == == == ==
let
appInitialized = false;
let
currentUser = null;
let
db = null;
let
auth = null;

function
initializeFirebase()
{
if (appInitialized)
return;

try {
// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–≤–µ–¥–µ–Ω—ã –ª–∏ –Ω–∞—Å—Ç–æ—è—â–∏–µ –∫–ª—é—á–∏
if (firebaseConfig.apiKey == = "AIzaSyCvBZ9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9Z9") {
alert("‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï!\n\n–í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –¥–µ–º–æ-–∫–ª—é—á–∏ Firebase. –î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:\n\n1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://console.firebase.google.com\n2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç\n3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ \"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞\" ‚Üí \"–í–∞—à–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è\"\n4. –î–æ–±–∞–≤—å—Ç–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥\n5. –í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥ –≤ —Å—Ç—Ä–æ–∫–∏ 220-227 —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞");
showFirebaseInstructions();
return;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
Firebase
firebase.initializeApp(firebaseConfig);
auth = firebase.auth();
db = firebase.firestore();

appInitialized = true;
console.log("‚úÖ Firebase —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");

// –°–ª—É—à–∞—Ç–µ–ª—å
—Å–æ—Å—Ç–æ—è–Ω–∏—è
–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
auth.onAuthStateChanged(user= > {
if (user)
{
    currentUser = user;
console.log("‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª:", user.email);

// –ü—Ä–æ–≤–µ—Ä—è–µ–º
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
–ø–æ—á—Ç—ã
if (!user.emailVerified)
{
    showScreen('verify-email-screen');
document.getElementById('email-not-verified').style.display = 'block';
document.getElementById('email-verified').style.display = 'none';
} else {
       // –ó–∞–≥—Ä—É–∂–∞–µ–º
–ø—Ä–æ–≥—Ä–µ—Å—Å
–∏–≥—Ä—ã
loadGameProgress();
updateUserDisplays();
showScreen('main-menu');
}
} else {
    currentUser = null;
showScreen('auth-screen');
}
});

} catch(error)
{
    console.error("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:", error);
alert(`–û—à–∏–±–∫–∞
–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
Firebase:\n${error.message}\n\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ
–∫–æ–Ω—Å–æ–ª—å
–±—Ä–∞—É–∑–µ—Ä–∞(F12)
–¥–ª—è
–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.
`);
}
}

// == == == == == == == == == == == == == == == == == == == ==
// –§–£–ù–ö–¶–ò–ò
–ê–í–¢–û–†–ò–ó–ê–¶–ò–ò
// == == == == == == == == == == == == == == == == == == == ==
function
showScreen(id)
{
    document.querySelectorAll('.screen').forEach(el= > el.classList.remove('active'));
document.getElementById(id).classList.add('active');

// –û—á–∏—Å—Ç–∫–∞
–ø–æ–ª–µ–π
–ø—Ä–∏
–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
if (id === 'register-screen')
{
    document.getElementById('register-email').value = '';
document.getElementById('register-password').value = '';
document.getElementById('register-confirm-password').value = '';
document.getElementById('register-loading').style.display = 'none';
} else if (id === 'auth-screen') {
document.getElementById('login-email').value = '';
document.getElementById('login-password').value = '';
document.getElementById('login-loading').style.display = 'none';
} else if (id == = 'password-reset-screen') {
document.getElementById('reset-email').value = '';
document.getElementById('reset-loading').style.display = 'none';
}
}

function updateUserDisplays() {
if (!currentUser)
return;

const
displayName = currentUser.displayName | | currentUser.email.split('@')[0];
const
emailVerified = currentUser.emailVerified ? ' ‚úÖ': ' ‚ö†Ô∏è';

document.querySelectorAll('.user-info').forEach(el= > {
    el.textContent = `üë§ ${displayName}${emailVerified}
`;
});
}

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
–ø–æ
–ø–æ—á—Ç–µasync
function
registerWithEmail()
{
const
email = document.getElementById('register-email').value.trim();
const
password = document.getElementById('register-password').value;
const
confirmPassword = document.getElementById('register-confirm-password').value;

// –í–∞–ª–∏–¥–∞—Ü–∏—è
if (!email | | !email.includes('@')) {
alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email!');
return;
}

if (password.length < 6) {
alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤!');
return;
}

if (password !== confirmPassword) {
alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!');
return;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º
Firebase
initializeFirebase();
if (!appInitialized)
return;

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º
—Å–ø–∏–Ω–Ω–µ—Ä
const
loadingSpinner = document.getElementById('register-loading');
loadingSpinner.style.display = 'block';
const
registerBtn = event.target;
registerBtn.disabled = true;

try {
// –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const userCredential = await auth.createUserWithEmailAndPassword(email, password);
const user = userCredential.user;

// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–∏—Å—å–º–æ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
await user.sendEmailVerification();

loadingSpinner.style.display = 'none';
registerBtn.disabled = false;

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
showScreen('verify-email-screen');
document.getElementById('email-not-verified').style.display = 'block';

alert(`‚úÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω!\n–ú—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –ø–∏—Å—å–º–æ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –Ω–∞ ${email}.\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Å—ã–ª–∫—É.`);

} catch (error) {
loadingSpinner.style.display = 'none';    registerBtn.disabled = false;

let errorMessage = '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ';
switch (error.code) {
case 'auth/email-already-in-use':
    errorMessage = '–≠—Ç–æ—Ç email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!';
break;
case
'auth/invalid-email':
errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email!';
break;
case
'auth/weak-password':
errorMessage = '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–π (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)!';
break;
default:
errorMessage = error.message;
}

alert(errorMessage);
console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
}
}

// –í—Ö–æ–¥
–ø–æ
–ø–æ—á—Ç–µ
async function
loginWithEmail()
{
    const
email = document.getElementById('login-email').value.trim();
const
password = document.getElementById('login-password').value;

if (!email | | !password)
{
    alert('–í–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å!');
return;
}

initializeFirebase();
if (!appInitialized)
return;

const
loadingSpinner = document.getElementById('login-loading');
loadingSpinner.style.display = 'block';
const
loginBtn = event.target;
loginBtn.disabled = true;

try {
await auth.signInWithEmailAndPassword(email, password);

loadingSpinner.style.display = 'none';
loginBtn.disabled = false;

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–π–¥–µ—Ç –Ω–∞ –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω —á–µ—Ä–µ–∑ onAuthStateChanged

} catch (error) {
loadingSpinner.style.display = 'none';    loginBtn.disabled = false;

let errorMessage = '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ';
switch (error.code) {
case 'auth/user-not-found':
    errorMessage = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω!';
break;
case
'auth/wrong-password':
errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!';
break;
case
'auth/invalid-email':
errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email!';
break;
case
'auth/user-disabled':
errorMessage = '–ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!';
break;
default:
errorMessage = error.message;
}

alert(errorMessage);
console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
}
}

// –í—Ö–æ–¥
—á–µ—Ä–µ–∑
Google
async function
loginWithGoogle()
{
    initializeFirebase();
if (!appInitialized)
return;

const
provider = new
firebase.auth.GoogleAuthProvider();

try {
await auth.signInWithPopup(provider);
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–π–¥–µ—Ç –Ω–∞ –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω

} catch (error) {
if (error.code != = 'auth/popup-closed-by-user') {
alert(`–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google: $
    {error.message}
`);
console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google:', error);
}
}
}

// –û—Ç–ø—Ä–∞–≤–∫–∞
–ø–∏—Å—å–º–∞
—Å
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
async function
sendVerificationEmail()
{
if (!currentUser) {
alert('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã!');
return;
}
const
loadingSpinner = document.getElementById('verify-loading');
loadingSpinner.style.display = 'block';

try {
await currentUser.sendEmailVerification();

loadingSpinner.style.display = 'none';
alert(`‚úÖ –ü–∏—Å—å–º–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ ${currentUser.email}!\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É.`);

} catch (error) {
loadingSpinner.style.display = 'none';
alert(`–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: $
    {error.message}
`);
console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞:', error);
}
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
–ø–æ—á—Ç—ã
async function
checkEmailVerification()
{
if (!currentUser) return;

const
loadingSpinner = document.getElementById('verify-loading');
loadingSpinner.style.display = 'block';

try {
await currentUser.reload();

loadingSpinner.style.display = 'none';

if (currentUser.emailVerified) {
document.getElementById('email-not-verified').style.display = 'none';
document.getElementById('email-verified').style.display = 'block';

// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä—ã
await loadGameProgress();
updateUserDisplays();
showScreen('main-menu');

showSuccessModal('üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É!');
} else {
alert('Email –µ—â–µ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Å—ã–ª–∫—É.');
}

} catch (error) {
loadingSpinner.style.display = 'none';
alert(`–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: $
    {error.message}
`);
console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—á—Ç—ã:', error);
}
}
// –°–±—Ä–æ—Å
–ø–∞—Ä–æ–ª—è
async function
sendPasswordReset()
{
const
email = document.getElementById('reset-email').value.trim();

if (!email | | !email.includes('@')) {
alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email!');
return;
}

initializeFirebase();
if (!appInitialized)
return;

const
loadingSpinner = document.getElementById('reset-loading');
loadingSpinner.style.display = 'block';

try {
await auth.sendPasswordResetEmail(email);

loadingSpinner.style.display = 'none';
alert(`‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –ø–∞—Ä–æ–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ ${email}!\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É.`);
showScreen('auth-screen');

} catch (error) {
loadingSpinner.style.display = 'none';

let errorMessage = '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ';
switch (error.code) {
case 'auth/user-not-found':
    errorMessage = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω!';
break;
case
'auth/invalid-email':
errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email!';
break;
default:
errorMessage = error.message;
}

alert(errorMessage);
console.error('–û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è:', error);
}
}

// –í—ã—Ö–æ–¥
–∏–∑
–∞–∫–∫–∞—É–Ω—Ç–∞
async function
signOut()
{
if (!auth)
{
    showScreen('auth-screen');
return;
}

try {// –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º
await saveGameProgress();

await auth.signOut();
currentUser = null;
gold = 0;
pet = null;
clearInterval(tickInterval);
clearInterval(goldInterval);
clearInterval(rageTimer);

showScreen('auth-screen');

} catch (error) {
alert(`–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞: $
    {error.message}
`);
console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
}
}

// == == == == == == == == == == == == == == == == == == == ==
// –°–û–•–†–ê–ù–ï–ù–ò–ï
–ò
–ó–ê–ì–†–£–ó–ö–ê
–ü–†–û–ì–†–ï–°–°–ê
–ò–ì–†–´
// == == == == == == == == == == == == == == == == == == == ==
async function
saveGameProgress()
{
if (!currentUser | | !db) return;

try {
const userDoc = db.collection('users').doc(currentUser.uid);

const data = {
gold: gold,
lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
};

if (pet) {
data.pet = {
name: pet.name,
petType: pet.petType,
hunger: pet.hunger,
happiness: pet.happiness,
energy: pet.energy,
rage: pet.rage,
alive: pet.alive,
isWildBeast: pet.isWildBeast,
maxStat: pet.maxStat,
rageCountdownActive: pet.rageCountdownActive,
rageCountdownTime: pet.rageCountdownTime
};
} else {
    data.pet = null;
}
await userDoc.set(data, {merge: true});
console.log('‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω');

} catch(error)
{
    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:', error);
}
}

async function
loadGameProgress()
{
if (!currentUser | | !db) return;

try {
const userDoc = await db.collection('users').doc(currentUser.uid).get();

if (userDoc.exists) {
const data = userDoc.data();

gold = data.gold | | 0;

if (data.pet) {
const savedPet = data.pet;
pet = new Pet(savedPet.name, savedPet.petType);
pet.hunger = savedPet.hunger;
pet.happiness = savedPet.happiness;
pet.energy = savedPet.energy;
pet.alive = savedPet.alive;

if (savedPet.isWildBeast) {
pet.rage = savedPet.rage | | 0;
pet.rageCountdownActive = savedPet.rageCountdownActive | | false;
pet.rageCountdownTime = savedPet.rageCountdownTime | | 0;

if (pet.rageCountdownActive) {
startRageCountdown();
}
}

// –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä—ã –∏–≥—Ä—ã
clearInterval(tickInterval);
tickInterval = setInterval(() = > {
if (pet) {pet.tick(); updateUI();}
}, 3000);

clearInterval(goldInterval);
goldInterval = setInterval(() = > {
gold += 1;
updateUI();
}, 5000);
}
updateUI();
console.log('‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∂–µ–Ω');
}

} catch (error) {
console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:', error);
}
}

function
showSuccessModal(message)
{
const
content = `
< div


class ="success-message" > ${message} < / div >

< br >
< button
onclick = "closeModal()" > OK < / button >
`;
openModal(content);
}

function
showFirebaseInstructions()
{
const
content = `
< h3 >üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
–ø–æ
–Ω–∞—Å—Ç—Ä–æ–π–∫–µ
Firebase < / h3 >
< ol
style = "text-align:left;margin:15px 0;line-height:1.6;" >
< li > –ü–µ—Ä–µ–π–¥–∏—Ç–µ
–Ω–∞ < a
href = "https://console.firebase.google.com"
target = "_blank"
style = "color:#4361ee;" > Firebase
Console < / a > < / li >
< li > –ù–∞–∂–º–∏—Ç–µ < strong > "–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç" < / strong > < / li >
< li > –í–≤–µ–¥–∏—Ç–µ
–Ω–∞–∑–≤–∞–Ω–∏–µ(–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¢–∞–º–∞–≥–æ—á–∏")
–∏
–Ω–∞–∂–º–∏—Ç–µ
"–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å" < / li >
< li > –û—Ç–∫–ª—é—á–∏—Ç–µ
Google
Analytics(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–∏
–Ω–∞–∂–º–∏—Ç–µ
"–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç" < / li >
< li > –ö–æ–≥–¥–∞
–ø—Ä–æ–µ–∫—Ç
—Å–æ–∑–¥–∞–Ω, –Ω–∞–∂–º–∏—Ç–µ < strong > "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞" < / strong > (—à–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞) < / li >
< li > –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ
–≤–Ω–∏–∑
–¥–æ
—Ä–∞–∑–¥–µ–ª–∞ < strong > "–í–∞—à–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" < / strong > < / li >
< li > –ù–∞–∂–º–∏—Ç–µ
–Ω–∞
–∏–∫–æ–Ω–∫—É < strong > Web( < / strong > < / li >
                                        < li > –í–≤–µ–¥–∏—Ç–µ
–∏–º—è
–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è(–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¢–∞–º–∞–≥–æ—á–∏ –≤–µ–±") < / li >
                                         < li > –°–∫–æ–ø–∏—Ä—É–π—Ç–µ
–æ–±—ä–µ–∫—Ç < strong > firebaseConfig < / strong > (–≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–æ–∫) < / li >
                                                                                      < li > –í—Å—Ç–∞–≤—å—Ç–µ
—ç—Ç–æ—Ç
–∫–æ–Ω—Ñ–∏–≥
–≤
–∫–æ–¥
–Ω–∞
—Å—Ç—Ä–æ–∫–∞—Ö
220 - 227 < / li >
              < li > –í
–∫–æ–Ω—Å–æ–ª–∏
Firebase
–ø–µ—Ä–µ–π–¥–∏—Ç–µ
–≤ < strong > Authentication < / strong > ‚Üí < strong > –ù–∞—á–∞–ª–æ
—Ä–∞–±–æ—Ç—ã < / strong > < / li >
                        < li > –í–∫–ª—é—á–∏—Ç–µ < strong > Email / Password < / strong > –∏ < strong > Google < / strong > –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã < / li >
                                                                                                                                 < li > –í < strong > Firestore
Database < / strong > —Å–æ–∑–¥–∞–π—Ç–µ
–±–∞–∑—É
–¥–∞–Ω–Ω—ã—Ö(–Ω–∞—á–Ω–∏—Ç–µ
–≤
—Ç–µ—Å—Ç–æ–≤–æ–º
—Ä–µ–∂–∏–º–µ) < / li >
            < / ol >
                < button
onclick = "closeModal()" > –ü–æ–Ω—è—Ç–Ω–æ < / button >
                                       `;
openModal(content);
}

// == == == == == == == == == == == == == == == == == == == ==
// –ò–ì–†–û–í–ê–Ø
–õ–û–ì–ò–ö–ê
// == == == == == == == == == == == == == == == == == == == ==
const
BASE_PET_TYPES = ["–°–æ–±–∞–∫–∞", "–ö–æ—à–∫–∞", "–ü–æ–ø—É–≥–∞–π"];
const
ADDON_PET_TYPES = [
    "–ê—Ä–∞–Ω–≥—É—Ç–∞–Ω—Ç",
    "–ß–µ—Ä–µ–ø–∞—Ö–∞",
    "–û–¥–∏–Ω–¥–∏–Ω–¥—É–Ω", "–ü—á–µ–ª–∞",
    "–±—Ä –±—Ä –±—Ä –±—Ä –ø–∞—Ç–∞–ø–∏–º",
    "gramma",
    "maddung",
    "Didiblat(NEW)",
    "–ö–æ—Ä–æ–≤–∞(NEW)"
];
const
SECRET_PET = "–ü–∞–Ω–¥–∞ (SECRET)";
const
MEGA_SECRET_PET = "–õ–µ–æ–ø–∞—Ä–¥ (MEGASECRET)";
const
WILD_BEASTS = new
Set([MEGA_SECRET_PET]);

let
pet = null;
let
enabledAddonTypes = new
Set();
let
interfaceStyle = "new_year";
let
theme = "dark";
let
tickInterval = null;
let
secretUnlocked = false;
let
megaSecretUnlocked = false;
let
gold = 0;
let
goldInterval = null;
let
satietyPotionActive = false;
let
satietyPotionTimer = null;
let
rageTimer = null;
let
gameEnded = false;


class Pet {
constructor(name, petType) {
this.name = name;
this.petType = petType;
this.isWildBeast = WILD_BEASTS.has(petType);

this.maxStat = this.isWildBeast ? 300: 100;
this.hunger = this.maxStat;
this.happiness = this.maxStat;
this.energy = this.maxStat;
this.rage = this.isWildBeast

? 0: null;
this.maxRage = 100;
this.alive = true;
this.rageCountdownActive = false;
this.rageCountdownTime = 0;
}

_clampStats()
{
    this.hunger = Math.max(0, Math.min(this.maxStat, this.hunger));
this.happiness = Math.max(0, Math.min(this.maxStat, this.happiness));
this.energy = Math.max(0, Math.min(this.maxStat, this.energy));

if (this.isWildBeast & & this.rage !== null)
{
    this.rage = Math.max(0, Math.min(this.maxRage, this.rage));
if (this.rage >= this.maxRage & & !this.rageCountdownActive)
{
    this.triggerRageCountdown();
}
}

if (this.hunger === 0) this.alive = false;
}

feed() {
if (!this.alive | | gameEnded)
return;
this.hunger += 20;
this.energy += 5;
if (this.isWildBeast) {
this.rage = Math.max(0, this.rage - 10);
}
this._clampStats();
}

play()
{
if (!this.alive | | gameEnded) return;
this.happiness += 15;
this.hunger -= 10;
this.energy -= 10;
if (this.isWildBeast) {
this.rage += 8;
}
this._clampStats();
}

sleep()
{
if (!this.alive | | gameEnded) return;
this.energy += 25;
this.hunger -= 5;
if (this.isWildBeast) {
this.rage = Math.max(0, this.rage - 15);
}
this._clampStats();
}

tick()
{
if (!this.alive | | gameEnded) return;

if (!satietyPotionActive) {
this.hunger -= 3;
}
this.happiness -= 1;
this.energy -= 1;

if (this.isWildBeast) {
this.rage += 3;}

this._clampStats();
}

revive()
{
if (!this.alive) {
this.alive = true;
this.hunger = Math.floor(this.maxStat / 2);
this.happiness = Math.floor(this.maxStat / 2);
this.energy = Math.floor(this.maxStat / 2);
this._clampStats();
}
}

boostAll()
{
this.hunger = Math.min(this.maxStat, this.hunger + 50);
this.happiness = Math.min(this.maxStat, this.happiness + 50);
this.energy = Math.min(this.maxStat, this.energy + 50);
this.alive = true;
this._clampStats();
}

calmDown(amount=50)
{
if (!this.isWildBeast | | !this.alive | | gameEnded) return false;
this.rage = Math.max(0, this.rage - amount);
this._clampStats();
return true;
}

triggerRageCountdown()
{
this.rageCountdownActive = true;
this.rageCountdownTime = 300;

showDangerModal("–í–∞—Å —Å—ä–µ–¥–∞–µ—Ç –î–∏–∫–∏–π –ó–≤–µ—Ä—å!");
startRageCountdown();
}

endGame()
{
clearInterval(rageTimer);
gameEnded = true;
showDangerModal(`–í–∞—Å
—Å—ä–µ–ª ${this.petType}!`);

document.getElementById('btn-feed').disabled = true;
document.getElementById('btn-play').disabled = true;
document.getElementById('btn-sleep').disabled = true;

saveGameProgress();
}
}
function
startRageCountdown()
{
    clearInterval(rageTimer);
rageTimer = setInterval(() = > {
if (!pet | | !pet.rageCountdownActive)
{
    clearInterval(rageTimer);
return;
}

pet.rageCountdownTime - -;

if (document.getElementById('warning-banner'))
{
document.getElementById('warning-banner').textContent =
`‚ö†Ô∏è
–î–∏–∫–∏–π
–ó–≤–µ—Ä—å
–Ω–∞–ø–∞–¥–µ—Ç
—á–µ—Ä–µ–∑ ${Math.floor(pet.rageCountdownTime / 60)}
–º–∏–Ω ${pet.rageCountdownTime % 60}
—Å–µ–∫!`;
document.getElementById('warning-banner').style.display = 'block';
}

if (pet.rageCountdownTime <= 0) {
pet.endGame();
}

if (pet.rageCountdownTime % 30 === 0) {
saveGameProgress();
}
}, 1000);
}

const
INTERFACE_METADATA = {
    new_year: {
        title: "–ù–æ–≤–æ–≥–æ–¥–Ω–∏–π —Ç–∞–º–∞–≥–æ—á–∏",
        decor: {left: "‚ùÜ", center: "–ó–∏–º–Ω—è—è —Å–∫–∞–∑–∫–∞", right: "‚ùÜ"},
        statsBanner: "–¢—ë–ø–ª–∞—è –∑–∞–±–æ—Ç–∞ —Å–æ–≥—Ä–µ–µ—Ç –¥–∞–∂–µ –≤ —Å–∞–º—ã–π —Å–Ω–µ–∂–Ω—ã–π –¥–µ–Ω—å",
        footer: "–ö–æ—Ä–º–∏—Ç–µ, –∏–≥—Ä–∞–π—Ç–µ –∏ —É–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ —Å–ø–∞—Ç—å ‚Äì –∏ –ø–∏—Ç–æ–º–µ—Ü –±—É–¥–µ—Ç —Å—á–∞—Å—Ç–ª–∏–≤"
    },
    halloween: {
        title: "–•–µ–ª—É–∏–Ω—Å–∫–∏–π —Ç–∞–º–∞–≥–æ—á–∏",
        decor: {left: "[ ]", center: "–ù–æ—á—å –•–µ–ª—É–∏–Ω–∞", right: "[ ]"},
        statsBanner: "–°–ª–µ–¥–∏ –∑–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º —Å–≤–æ–µ–≥–æ —Ç–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞",
        footer: "–ö–æ—Ä–º–∏—Ç–µ, –∏–≥—Ä–∞–π—Ç–µ –∏ –æ—Ç–¥—ã—Ö–∞–π—Ç–µ, —á—Ç–æ–±—ã –ø—Ä–æ–≥–Ω–∞—Ç—å —Ç—å–º—É"
    },
    holiday: {
        title: "–ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π —Ç–∞–º–∞–≥–æ—á–∏",
        decor: {left: "* *", center: "–ü—Ä–∞–∑–¥–Ω–∏—á–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", right: "* *"},
        statsBanner: "–ü—É—Å—Ç—å –ø—Ä–∞–∑–¥–Ω–∏–∫ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è ‚Äì –±–µ—Ä–µ–≥–∏ —Å–∏–ª—ã –∏ —Ä–∞–¥–æ—Å—Ç—å –ø–∏—Ç–æ–º—Ü–∞",
        footer: "–ò–≥—Ä—ã –∏ —É–≥–æ—â–µ–Ω–∏—è –¥–µ–ª–∞—é—Ç –ø—Ä–∞–∑–¥–Ω–∏–∫ —è—Ä—á–µ"
    }
};

function
closeModal()
{
    document.getElementById('modal').style.display = 'none';}

function
openModal(content)
{
    document.getElementById('modal-content').innerHTML = content;
document.getElementById('modal').style.display = 'flex';
}

function
showDangerModal(message)
{
    const
content = `
          < div


class ="danger-message" > ${message} < / div >

< br >
< button
onclick = "closeModal()" > –ü–æ–Ω—è—Ç–Ω–æ < / button >
`;
openModal(content);
setTimeout(closeModal, 3000);
}

function
applyInterfaceMetadata()
{
const
meta = INTERFACE_METADATA[interfaceStyle];
document.title = meta.title;
if (document.getElementById('main-title')) {
document.getElementById('main-title').textContent = meta.title;
}
document.querySelector('.decor-left').textContent = meta.decor.left;
document.querySelector('.decor-center').textContent = meta.decor.center;
document.querySelector('.decor-right').textContent = meta.decor.right;
if (document.querySelector('.stats-banner')) {
document.querySelector('.stats-banner').textContent = meta.statsBanner;
}
if (document.querySelector('.footer')) {
document.querySelector('.footer').textContent = meta.footer;
}
const
bgMap = {
    new_year: 'linear-gradient(to bottom, #04101f, #0d2438)',
    halloween: 'linear-gradient(to bottom, #120818, #241020)',
    holiday: 'linear-gradient(to bottom, #021b21, #062b35)'
};
document.body.style.background = bgMap[interfaceStyle];
}

function
refreshPetTypes()
{
const
select = document.getElementById('pet-type');
if (!select) return;

select.innerHTML = '';
const
allTypes = [...BASE_PET_TYPES];
ADDON_PET_TYPES.forEach(type= > {
if (enabledAddonTypes.has(type))
allTypes.push(type);
});
if (secretUnlocked) {allTypes.push(SECRET_PET);
}
if (megaSecretUnlocked) {
allTypes.push(MEGA_SECRET_PET);
}
allTypes.forEach(type= > {
    const
option = document.createElement('option');
option.value = type;
option.textContent = type;
select.appendChild(option);
});
}

function
updateUI()
{
if (!pet) {
document.getElementById('pet-info').textContent = "–ü–∏—Ç–æ–º–µ—Ü –µ—â—ë –Ω–µ —Å–æ–∑–¥–∞–Ω.";
document.getElementById('hunger').textContent = "–°—ã—Ç–æ—Å—Ç—å: -";
document.getElementById('happiness').textContent = "–°—á–∞—Å—Ç—å–µ: -";
document.getElementById('energy').textContent = "–≠–Ω–µ—Ä–≥–∏—è: -";
document.getElementById('rage').style.display = 'none';
document.getElementById('warning-banner').style.display = 'none';
} else {
const status = pet.alive ? "–∂–∏–≤–æ–π": "–º–µ—Ä—Ç–≤";
document.getElementById('pet-info').textContent = `${pet.petType}
–ø–æ
–∏–º–µ–Ω–∏ ${pet.name} ‚Äî ${status}.
`;
document.getElementById('hunger').textContent = `–°—ã—Ç–æ—Å—Ç—å: ${pet.hunger}${satietyPotionActive ? ' (‚ú®)': ''}`;
document.getElementById('happiness').textContent = `–°—á–∞—Å—Ç—å–µ: ${pet.happiness}
`;
document.getElementById('energy').textContent = `–≠–Ω–µ—Ä–≥–∏—è: ${pet.energy}
`;

if (pet.isWildBeast)
{
    document.getElementById('rage').style.display = 'block';
document.getElementById('rage').textContent = `–Ø—Ä–æ—Å—Ç—å: ${pet.rage} /${pet.maxRage}
`;

const
ragePercent = (pet.rage / pet.maxRage) * 100;
if (ragePercent > 70)
{
    document.getElementById('rage').style.color = '#d32f2f';
} else if (ragePercent > 40) {
document.getElementById('rage').style.color = '#ff9800';
} else {
document.getElementById('rage').style.color = '#4caf50';
}

if (ragePercent > 80 & & !pet.rageCountdownActive) {
document.getElementById('warning-banner').textContent = `‚ö†Ô∏è ${pet.petType} —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ–ø–∞—Å–Ω—ã–º!`;
document.getElementById('warning-banner').style.display = 'block';
} else if (!pet.rageCountdownActive) {
document.getElementById('warning-banner').style.display = 'none';
}
} else {
document.getElementById('rage').style.display = 'none';
document.getElementById('warning-banner').style.display = 'none';}

const buttonsEnabled = pet.alive & & !gameEnded;
document.getElementById('btn-feed').disabled = !buttonsEnabled;
document.getElementById('btn-play').disabled = !buttonsEnabled;
document.getElementById('btn-sleep').disabled = !buttonsEnabled;

const calmBtn = document.getElementById('btn-calm');
if (calmBtn) {
if (pet.isWildBeast & & pet.alive & & !gameEnded) {
calmBtn.classList.remove('grayed');
calmBtn.disabled = false;
} else {
calmBtn.classList.add('grayed');
calmBtn.disabled = true;
}
}
}

document.getElementById('gold').textContent = gold;

if (currentUser & & document.getElementById('menu-user-info')) {
const displayName = currentUser.displayName | | currentUser.email.split('@')[0];
document.getElementById('menu-user-info').textContent = `üë§ ${displayName} | –ú–æ–Ω–µ—Ç—ã: $
    {gold} ü™ô`;
}
}

function
onFeed()
{ if (pet)
{pet.feed();
updateUI();
saveGameProgress();}}
function
onPlay()
{ if (pet)
{pet.play();
updateUI();
saveGameProgress();}}
function
onSleep()
{ if (pet)
{pet.sleep();
updateUI();
saveGameProgress();}}

function
buyPotion(type)
{
let
cost = 0;
let
success = false;

if (type === 'revive' & & pet & & !pet.alive) {
cost = 50;
if (gold >= cost) {
gold -= cost;
pet.revive();
success = true;
}
} else if (type == = 'satiety' & & pet & & pet.alive & & !gameEnded) {
cost = 30;
if (gold >= cost) {
gold -= cost;
satietyPotionActive = true;
success = true;
if (satietyPotionTimer) clearTimeout(satietyPotionTimer);
satietyPotionTimer = setTimeout(() = > {satietyPotionActive = false;
satietyPotionTimer = null;
updateUI();
}, 5 * 60 * 1000);
}
} else if (type == = 'strength' & & pet & & !gameEnded) {
cost = 40;
if (gold >= cost) {
gold -= cost;
pet.boostAll();
success = true;
}
} else if (type == = 'calm' & & pet & & pet.isWildBeast & & pet.alive & & !gameEnded) {
cost = 20;
if (gold >= cost) {
gold -= cost;
pet.calmDown(50);
success = true;
}
}

if (success) {
updateUI();
saveGameProgress();
const message = ` < div


class ="success-message" > ‚úÖ –ö—É–ø–ª–µ–Ω–æ! < / div > `;


document.getElementById('modal-content').insertAdjacentHTML('beforeend', message);
setTimeout(() = > {
    const
msg = document.querySelector('.success-message');
if (msg)
msg.remove();
}, 2000);
} else {
if (type === 'calm' & & pet & & !pet.isWildBeast) {
alert("–ó–µ–ª—å–µ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –î–∏–∫–∏—Ö –ó–≤–µ—Ä—è—Ö!");
} else {
alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ!");
}
}
}

function
createPet()
{
    const
name = document.getElementById('pet-name').value.trim() | | "–ü–∏—Ç–æ–º–µ—Ü";
const
type = document.getElementById('pet-type').value;
pet = new
Pet(name, type);
gameEnded = false;
satietyPotionActive = false;
if (satietyPotionTimer)
{
clearTimeout(satietyPotionTimer);
satietyPotionTimer = null;
}
updateUI();
showScreen('game-screen');

clearInterval(tickInterval);
tickInterval = setInterval(() = > {
if (pet)
{pet.tick();
updateUI();
saveGameProgress();}
}, 3000);

clearInterval(goldInterval);
goldInterval = setInterval(() = > {
    gold += 1;
updateUI();
saveGameProgress();
}, 5000);
}

function
showCreateScreen()
{
    refreshPetTypes();
showScreen('create-screen');
if (currentUser)
{
const
displayName = currentUser.displayName | | currentUser.email.split('@')[0];
document.getElementById('create-user-info').textContent = `üë§ ${displayName}
`;
}
}

function
openSettings()
{
    const
currentTheme = theme;
const
content = `
          < h3 > –ù–∞—Å—Ç—Ä–æ–π–∫–∏ < / h3 >
                               < p > –¢–µ–º–∞
–∏–≥—Ä—ã: < / p >
          < label >
          < input
type = "radio"
name = "theme"
value = "dark" ${currentTheme == = 'dark' ? 'checked': ''} >
–¢—ë–º–Ω–∞—è
< / label >
    < label >
    < input
type = "radio"
name = "theme"
value = "light" ${currentTheme == = 'light' ? 'checked': ''} >
–°–≤–µ—Ç–ª–∞—è
< / label >
    < br > < br >
    < button
onclick = "saveSettings()" > –°–æ—Ö—Ä–∞–Ω–∏—Ç—å < / button >
                                           `;
openModal(content);
}

function
saveSettings()
{
    const
radios = document.getElementsByName('theme');
for (let radio of radios) if (radio.checked)
theme = radio.value;
closeModal();
}

function
showCredits()
{openModal(`
< h3 > –°–æ–∑–¥–∞—Ç–µ–ª–∏ < / h3 >
< p > Raskrobl(Honexe) - —Å
–ø–æ–º–æ—â—å—é
–Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π. < / p >
< button
onclick = "closeModal()" > –ó–∞–∫—Ä—ã—Ç—å < / button >
`);
}

function
openAddons()
{
    let
checkboxes = '';
ADDON_PET_TYPES.forEach(type= > {
    const
checked = enabledAddonTypes.has(type) ? 'checked': '';
checkboxes += ` < label > < input
type = "checkbox"
value = "${type}" ${checked} > ${type} < / label > `;
});
const
content = `
          < h3 > –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ
–∂–∏–≤–æ—Ç–Ω—ã–µ: < / h3 >
              < div


class ="checkbox-list" > ${checkboxes} < / div >

< br >
< button
onclick = "saveAddons()" > –°–æ—Ö—Ä–∞–Ω–∏—Ç—å < / button >
`;
openModal(content);
}

function
saveAddons()
{
enabledAddonTypes.clear();
document.querySelectorAll('#modal-content input[type="checkbox"]:checked')
.forEach(cb= > enabledAddonTypes.add(cb.value));
closeModal();
refreshPetTypes();
}

function
openInterfaceSettings()
{
const
current = interfaceStyle;
const
content = `
< h3 > –í—ã–±–µ—Ä–∏—Ç–µ
–≤–∞—Ä–∏–∞–Ω—Ç
–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: < / h3 >
< label >
< input
type = "radio"
name = "iface"
value = "new_year" ${current == = 'new_year' ? 'checked': ''} >
–ù–æ–≤–æ–≥–æ–¥–Ω–∏–π
–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å(–±–∞–∑–æ–≤—ã–π)
< / label >
< label >
< input
type = "radio"
name = "iface"
value = "halloween" ${current == = 'halloween' ? 'checked': ''} >
–•–µ–ª—É–∏–Ω—Å–∫–∏–π
–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
< / label >
< label >
< input
type = "radio"
name = "iface"
value = "holiday" ${current == = 'holiday' ? 'checked': ''} >
–ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π
–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
< / label >
< br > < br >
< button
onclick = "saveInterface()" > –°–æ—Ö—Ä–∞–Ω–∏—Ç—å < / button >
`;
openModal(content);}

function
saveInterface()
{
const
radios = document.getElementsByName('iface');
for (let radio of radios) if (radio.checked) interfaceStyle = radio.value;
applyInterfaceMetadata();
closeModal();
}

function
openSecretMenu()
{
const
content = `
< h3 > –ü–æ–¥–∞—Ä–∫–∏ < / h3 >
< p > –í–≤–µ–¥–∏—Ç–µ
—Å–µ–∫—Ä–µ—Ç–Ω—ã–π
–∫–æ–¥, —á—Ç–æ–±—ã
—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
–æ—Å–æ–±–æ–µ
–∂–∏–≤–æ—Ç–Ω–æ–µ: < / p >
< input
type = "password"
id = "secret-code"
placeholder = "‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
maxlength = "20" / >
< br > < br >
< button
onclick = "submitSecretCode()" > –ü—Ä–∏–º–µ–Ω–∏—Ç—å < / button >
< button
onclick = "closeModal()" > –û—Ç–º–µ–Ω–∞ < / button >
`;
openModal(content);
}

function
submitSecretCode()
{
const
code = document.getElementById('secret-code').value.trim();
if (code === "1x1x1") {
secretUnlocked = true;
const message = ` < div


class ="success-message" > ‚úÖ –°–µ–∫—Ä–µ—Ç–Ω–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ ¬´${SECRET_PET}¬ª –¥–æ–±–∞–≤–ª–µ–Ω–æ! < / div > `;


document.getElementById('modal-content').insertAdjacentHTML('beforeend', message);
refreshPetTypes();
} else if (code === "–í–∫–∞–º–∏–Ω–µ–≤—à–µ—Å—Ç—å—É—Ç—Ä–∞") {
megaSecretUnlocked = true;
const
message = ` < div


class ="success-message" > ‚úÖ MEGASECRET –∂–∏–≤–æ—Ç–Ω–æ–µ ¬´${MEGA_SECRET_PET}¬ª –¥–æ–±–∞–≤–ª–µ–Ω–æ! < / div > `;


document.getElementById('modal-content').insertAdjacentHTML('beforeend', message);
refreshPetTypes();
} else {
alert("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.");
}
}

document.getElementById('modal').onclick = function(e)
{
if (e.target === this)
closeModal();
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
–ø—Ä–∏
–∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', () = > {
applyInterfaceMetadata();
refreshPetTypes();
initializeFirebase();
});
< / script >
    < / body >
        < / html >
